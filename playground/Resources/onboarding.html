<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Onboarding</title>

    <style>
      :root {
        /* iOS-friendly system palette */
        --bg0: #0b0c10;
        --bg1: #0f1220;
        --card: #121527cc;
        --cardSolid: #14182c;
        --text: #f6f7fb;
        --muted: #a9afbf;
        --muted2: #7c8396;
        --stroke: #252a3d;
        --stroke2: #2f3550;
        --shadow: 0 16px 44px rgba(0, 0, 0, 0.4);

        --accent: #6d7cff;
        --accent2: #27d3a7;
        --danger: #ff5a7a;
        --warning: #ffcc66;

        --radius: 22px;
        --radiusSm: 14px;

        --tap: 52px;
        --maxW: 520px;

        --safeT: env(safe-area-inset-top);
        --safeB: env(safe-area-inset-bottom);
        --safeL: env(safe-area-inset-left);
        --safeR: env(safe-area-inset-right);
      }

      @media (prefers-color-scheme: light) {
        :root {
          --bg0: #f5f7ff;
          --bg1: #ffffff;
          --card: #ffffffcc;
          --cardSolid: #ffffff;
          --text: #111426;
          --muted: #5a637a;
          --muted2: #7b849b;
          --stroke: #e6eaf5;
          --stroke2: #d9deef;
          --shadow: 0 14px 40px rgba(16, 18, 36, 0.14);
          --accent: #4454ff;
          --accent2: #16bfa1;
        }
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        color: var(--text);
        font-family:
          -apple-system, BlinkMacSystemFont,
          "SF Pro Display", "SF Pro Text",
          system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        background:
          radial-gradient(900px 560px at 10% 10%, rgba(109,124,255,.35), transparent 55%),
          radial-gradient(760px 520px at 90% 20%, rgba(39,211,167,.22), transparent 55%),
          radial-gradient(760px 520px at 50% 110%, rgba(109,124,255,.18), transparent 60%),
          linear-gradient(180deg, var(--bg0), var(--bg1));
        overflow-x: hidden;
      }

      .app {
        min-height: 100%;
        padding:
          calc(16px + var(--safeT))
          calc(16px + var(--safeR))
          calc(18px + var(--safeB))
          calc(16px + var(--safeL));
        display: flex;
        justify-content: center;
        align-items: stretch;
      }

      .shell {
        width: 100%;
        max-width: var(--maxW);
        display: flex;
        flex-direction: column;
        gap: 14px;
      }

      .topbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 4px 2px;
      }

      .navBtn {
        height: 44px;
        min-width: 44px;
        padding: 0 12px;
        border-radius: 999px;
        border: 1px solid var(--stroke);
        background: color-mix(in srgb, var(--cardSolid) 55%, transparent);
        color: var(--text);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
        transition: transform .08s ease, background .18s ease, border-color .18s ease;
      }
      .navBtn:active { transform: scale(.985); }
      .navBtn[disabled] { opacity: .45; cursor: not-allowed; }
      .navBtn .icon { width: 18px; height: 18px; display: inline-block; }

      .brand { display:flex; align-items:center; gap:10px; min-width: 0; }
      .mark {
        width: 34px; height: 34px;
        border-radius: 12px;
        background:
          radial-gradient(14px 14px at 35% 35%, rgba(255,255,255,.55), transparent 60%),
          linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 10px 26px rgba(109, 124, 255, 0.25);
      }
      .brandText { display:flex; flex-direction:column; min-width:0; }
      .brandText b {
        font-size: 14px; letter-spacing:.2px;
        white-space: nowrap; overflow:hidden; text-overflow:ellipsis;
      }
      .brandText span {
        font-size: 12px; color: var(--muted2);
        white-space: nowrap; overflow:hidden; text-overflow:ellipsis;
      }

      .progressWrap { width: 100%; padding: 10px 4px 0; }
      .progressRow {
        display:flex; align-items:center; justify-content:space-between;
        gap: 10px; margin-bottom: 8px;
        color: var(--muted2); font-size: 12px;
      }
      .bar {
        height: 8px; border-radius: 999px;
        background: color-mix(in srgb, var(--stroke) 70%, transparent);
        overflow: hidden;
        border: 1px solid color-mix(in srgb, var(--stroke2) 75%, transparent);
      }
      .bar > i {
        display:block; height:100%; width:0%;
        border-radius: 999px;
        background: linear-gradient(90deg, var(--accent), var(--accent2));
        transition: width .32s cubic-bezier(.2,.8,.2,1);
      }

      .card {
        position: relative;
        border-radius: var(--radius);
        background: var(--card);
        backdrop-filter: blur(14px);
        -webkit-backdrop-filter: blur(14px);
        border: 1px solid color-mix(in srgb, var(--stroke) 70%, transparent);
        box-shadow: var(--shadow);
        padding: 18px;
        overflow: hidden;
      }
      .card::before {
        content: "";
        position: absolute;
        inset: -2px;
        pointer-events: none;
        background:
          radial-gradient(280px 160px at 20% 0%, rgba(109,124,255,.16), transparent 55%),
          radial-gradient(260px 180px at 90% 20%, rgba(39,211,167,.12), transparent 55%);
        opacity: .9;
      }
      .cardInner { position: relative; }

      h1 { margin: 2px 0 6px; font-size: 24px; line-height: 1.2; letter-spacing: -0.2px; }
      p.desc { margin: 0 0 14px; color: var(--muted); font-size: 14px; line-height: 1.45; }

      .fields { display:flex; flex-direction:column; gap:12px; margin-top:8px; }
      .field { display:flex; flex-direction:column; gap:8px; }
      .labelRow { display:flex; align-items:baseline; justify-content:space-between; gap:10px; }
      label { font-size: 13px; color: color-mix(in srgb, var(--text) 92%, var(--muted)); letter-spacing:.2px; }
      .req { font-size: 12px; color: var(--muted2); }

      .control {
        display:flex; align-items:center; gap:10px;
        background: color-mix(in srgb, var(--cardSolid) 78%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        border-radius: var(--radiusSm);
        padding: 10px 12px;
        min-height: var(--tap);
      }

      input, select, button { font: inherit; color: inherit; }
      input[type="number"], input[type="text"], input[type="date"] {
        appearance: none; -webkit-appearance:none;
        border: 0; outline: none; background: transparent;
        width: 100%; font-size: 16px;
      }
      input[type="date"] { min-height: 22px; }

      select {
        border: 0; outline: none;
        background: transparent; color: var(--text);
        font-size: 14px;
        padding: 6px 10px;
        border-radius: 12px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 78%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 86%, transparent);
        min-width: 84px;
      }

      .hint { font-size: 12px; color: var(--muted2); margin-top: -2px; }

      .error {
        display:none;
        font-size: 12px;
        color: color-mix(in srgb, var(--danger) 90%, var(--text));
        margin-top: 2px;
      }
      .field.invalid .control {
        border-color: color-mix(in srgb, var(--danger) 70%, var(--stroke2));
        box-shadow: 0 0 0 3px color-mix(in srgb, var(--danger) 20%, transparent);
      }
      .field.invalid .error { display:block; }

      .options { display:flex; flex-direction:column; gap:10px; margin-top:10px; }
      .opt {
        text-align:left;
        width:100%;
        min-height: var(--tap);
        padding: 14px 14px;
        border-radius: 18px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 78%, transparent);
        cursor:pointer;
        -webkit-tap-highlight-color: transparent;
        display:flex; align-items:center; justify-content:space-between; gap:12px;
        transition: transform .08s ease, border-color .18s ease, background .18s ease;
      }
      .opt:active { transform: scale(.99); }
      .opt .sub { font-size: 12px; color: var(--muted2); margin-top: 2px; }
      .opt strong { display:block; font-size: 15px; }

      .pill {
        width: 26px; height: 26px;
        border-radius: 999px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 80%, transparent);
        display:grid; place-items:center;
        flex: 0 0 auto;
        background: transparent;
      }
      .pill i {
        width: 14px; height: 14px;
        border-radius: 6px;
        background: transparent;
        transition: background .18s ease, transform .18s ease;
        transform: scale(.85);
      }
      .opt.selected {
        border-color: color-mix(in srgb, var(--accent) 70%, var(--stroke2));
        background: color-mix(in srgb, var(--accent) 12%, var(--cardSolid));
      }
      .opt.selected .pill {
        border-color: color-mix(in srgb, var(--accent) 70%, var(--stroke2));
        background: color-mix(in srgb, var(--accent) 18%, transparent);
      }
      .opt.selected .pill i {
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        transform: scale(1);
      }

      .sliderWrap { margin-top: 8px; display:flex; flex-direction:column; gap:10px; }
      .sliderHead { display:flex; align-items:baseline; justify-content:space-between; gap:10px; }
      .valueBubble { font-weight: 700; font-size: 18px; letter-spacing: -0.2px; }
      .unit { font-size: 12px; color: var(--muted2); margin-left: 6px; font-weight: 600; }

      input[type="range"] {
        width: 100%;
        height: 34px;
        background: transparent;
        padding: 0; margin: 0;
        -webkit-tap-highlight-color: transparent;
      }
      input[type="range"]::-webkit-slider-runnable-track{
        height: 8px;
        border-radius: 999px;
        background: color-mix(in srgb, var(--stroke) 70%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 72%, transparent);
      }
      input[type="range"]::-webkit-slider-thumb{
        -webkit-appearance:none;
        width: 26px; height: 26px; margin-top: -10px;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        border: 3px solid color-mix(in srgb, var(--cardSolid) 90%, transparent);
        box-shadow: 0 10px 26px rgba(0,0,0,.25);
      }
      input[type="range"]::-moz-range-track{
        height: 8px; border-radius: 999px;
        background: color-mix(in srgb, var(--stroke) 70%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 72%, transparent);
      }
      input[type="range"]::-moz-range-thumb{
        width: 26px; height: 26px;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        border: 3px solid color-mix(in srgb, var(--cardSolid) 90%, transparent);
        box-shadow: 0 10px 26px rgba(0,0,0,.25);
      }

      .footer { display:flex; gap:10px; margin-top:14px; }

      .btn {
        flex:1;
        min-height: var(--tap);
        border-radius: 18px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 78%, transparent);
        cursor:pointer;
        -webkit-tap-highlight-color: transparent;
        user-select:none;
        transition: transform .08s ease, background .18s ease, border-color .18s ease, opacity .18s ease;
        font-weight: 700;
        letter-spacing: .2px;
      }
      .btn:active { transform: scale(.99); }
      .btn.primary {
        border: none;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 16px 38px rgba(109, 124, 255, 0.2);
        color: #0b0c10;
      }
      .btn.primary:disabled { opacity: .55; cursor:not-allowed; box-shadow:none; }
      .btn.ghost {
        background: transparent;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        color: var(--text);
      }

      .hero {
        margin: 12px 0 10px;
        border-radius: 22px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        background:
          radial-gradient(260px 120px at 20% 40%, rgba(109,124,255,.24), transparent 55%),
          radial-gradient(260px 120px at 80% 40%, rgba(39,211,167,.20), transparent 55%),
          linear-gradient(180deg, color-mix(in srgb, var(--cardSolid) 85%, transparent), transparent);
        height: 120px;
        position: relative;
        overflow: hidden;
      }
      .hero::after {
        content: "";
        position: absolute;
        inset: 18px;
        border-radius: 18px;
        border: 1px dashed color-mix(in srgb, var(--stroke2) 70%, transparent);
        opacity: .7;
      }
      .heroBadge {
        position: absolute;
        left: 14px; top: 14px;
        padding: 8px 10px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 700;
        color: color-mix(in srgb, var(--text) 92%, var(--muted));
        background: color-mix(in srgb, var(--cardSolid) 70%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
      }

      .row { display:flex; align-items:center; justify-content:space-between; gap:10px; }
      .srOnly { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }

      .fadeIn { animation: fadeIn .22s ease both; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(6px);} to { opacity:1; transform: translateY(0);} }

      /* Goals Generation Styles */
      .goalsGenWrap {
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        min-height: 320px;
        text-align:center;
        gap: 24px;
      }

      .loadingCircles { position:relative; width:140px; height:140px; }
      .loadingCircles .ring { position:absolute; inset:0; border-radius:50%; border: 3px solid transparent; }
      .loadingCircles .ring1 { border-top-color: var(--accent); border-right-color: var(--accent); animation: spin 1.2s linear infinite; }
      .loadingCircles .ring2 { inset: 12px; border-bottom-color: var(--accent2); border-left-color: var(--accent2); animation: spin 1.6s linear infinite reverse; }
      .loadingCircles .ring3 { inset: 24px; border-top-color: var(--accent); animation: spin 2s linear infinite; }
      .loadingCircles .centerIcon { position:absolute; inset:36px; display:grid; place-items:center; font-size: 32px; animation: pulse 1.5s ease-in-out infinite; }
      @keyframes spin { to { transform: rotate(360deg);} }
      @keyframes pulse { 0%,100% { transform: scale(1); opacity:1;} 50% { transform: scale(1.1); opacity:.8;} }

      .loadingStatus { font-size: 14px; color: var(--muted); animation: fadeIn .3s ease; }

      .successCheck {
        width: 80px; height: 80px; border-radius: 50%;
        background: linear-gradient(135deg, rgba(39,211,167,.2), rgba(39,211,167,.1));
        display:grid; place-items:center;
        font-size: 36px;
        animation: scaleIn .4s cubic-bezier(.2,.8,.2,1.2);
      }
      @keyframes scaleIn { from { transform: scale(0); opacity:0;} to { transform: scale(1); opacity:1;} }

      .goalsCards { display:flex; flex-direction:column; gap:12px; width:100%; margin-top:8px; }

      .goalCard {
        display:flex;
        align-items:center;
        gap: 14px;
        padding: 16px;
        border-radius: 16px;
        background: color-mix(in srgb, var(--cardSolid) 85%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        animation: slideUp .35s ease both;
      }
      .goalCard:nth-child(1){ animation-delay: .05s; }
      .goalCard:nth-child(2){ animation-delay: .10s; }
      .goalCard:nth-child(3){ animation-delay: .15s; }
      .goalCard:nth-child(4){ animation-delay: .20s; }
      @keyframes slideUp { from { opacity:0; transform: translateY(12px);} to { opacity:1; transform: translateY(0);} }

      .goalIcon {
        width: 44px; height: 44px;
        border-radius: 12px;
        display:grid; place-items:center;
        font-size: 22px;
        flex: 0 0 auto;
      }
      .goalIcon.calories { background: linear-gradient(135deg, rgba(255,140,60,.25), rgba(255,90,40,.15)); }
      .goalIcon.protein { background: linear-gradient(135deg, rgba(255,90,122,.25), rgba(255,60,90,.15)); }
      .goalIcon.carbs { background: linear-gradient(135deg, rgba(39,211,167,.25), rgba(20,180,140,.15)); }
      .goalIcon.fat { background: linear-gradient(135deg, rgba(255,204,102,.25), rgba(255,180,60,.15)); }

      .goalInfo { flex: 1; text-align:left; }
      .goalInfo .label { font-size: 12px; color: var(--muted2); margin-bottom: 2px; }
      .goalInfo .value { font-size: 20px; font-weight: 700; letter-spacing: -0.2px; }
      .goalInfo .value .unit { font-size: 13px; font-weight: 600; color: var(--muted); margin-left: 4px; }

      .macrosRow { display:flex; gap:10px; }
      .macrosRow .goalCard { flex:1; flex-direction:column; text-align:center; padding: 14px 10px; }
      .macrosRow .goalIcon { width: 38px; height: 38px; font-size: 18px; }
      .macrosRow .goalInfo { text-align:center; }
      .macrosRow .goalInfo .value { font-size: 18px; }

      /* Activity level question */
      .activityOpts .opt .sub { max-width: 220px; }

      /* Gender selection */
      .genderOpts { display:flex; gap:12px; }
      .genderOpts .opt { flex:1; flex-direction:column; text-align:center; padding: 20px 14px; }
      .genderOpts .opt .genderIcon { font-size: 32px; margin-bottom: 8px; }

      /* Hidden state for topbar during generation */
      .topbar.hidden, .progressWrap.hidden {
        opacity: 0;
        pointer-events:none;
        transition: opacity .25s ease;
      }
    </style>
  </head>

  <body>
    <div class="app">
      <div class="shell">
        <div class="topbar" id="topbar">
          <button class="navBtn" id="backBtn" type="button" aria-label="Go back">
            <span class="icon" aria-hidden="true">‚Üê</span>
            <span style="font-weight:700;font-size:14px;">Back</span>
          </button>

          <div class="brand" aria-label="Onboarding">
            <div class="mark" aria-hidden="true"></div>
            <div class="brandText">
              <b>Personal plan setup</b>
              <span id="stepMeta">Step</span>
            </div>
          </div>

          <button class="navBtn" id="skipBtn" type="button">
            <span style="font-weight:700;font-size:14px;">Skip</span>
          </button>
        </div>

        <div class="progressWrap" id="progressWrap" aria-hidden="true">
          <div class="progressRow">
            <span id="progressText">0%</span>
            <span id="progressSteps">0 / 0</span>
          </div>
          <div class="bar"><i id="progressFill"></i></div>
        </div>

        <div class="card" role="region" aria-live="polite" aria-atomic="true">
          <div class="cardInner" id="content"></div>
        </div>

        <div class="footer" id="footer"></div>
      </div>
    </div>

    <!-- JS injected exactly like splash_blue.html -->
    <script>#SPLASH_JS#</script>
  </body>
</html>
