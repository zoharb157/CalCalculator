<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Onboarding</title>

    <style>
      :root {
        /* Enhanced iOS-friendly color palette */
        --bg0: #0a0e1a;
        --bg1: #0d1117;
        --card: #161b27e6;
        --cardSolid: #161b27;
        --text: #f8fafc;
        --muted: #a0aec0;
        --muted2: #718096;
        --stroke: #2d3748;
        --stroke2: #374151;
        --shadow: 0 20px 50px rgba(0, 0, 0, 0.5);

        --accent: #7c3aed;
        --accent2: #10b981;
        --danger: #ef4444;
        --warning: #f59e0b;
        --success: #10b981;

        --radius: 24px;
        --radiusSm: 16px;

        --tap: 56px;
        --maxW: 480px;

        --safeT: env(safe-area-inset-top);
        --safeB: env(safe-area-inset-bottom);
        --safeL: env(safe-area-inset-left);
        --safeR: env(safe-area-inset-right);
      }

      @media (prefers-color-scheme: light) {
        :root {
          --bg0: #f8fafc;
          --bg1: #ffffff;
          --card: #ffffffe6;
          --cardSolid: #ffffff;
          --text: #1e293b;
          --muted: #64748b;
          --muted2: #94a3b8;
          --stroke: #e2e8f0;
          --stroke2: #cbd5e1;
          --shadow: 0 20px 50px rgba(15, 23, 42, 0.12);
          --accent: #7c3aed;
          --accent2: #10b981;
        }
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; }
      body {
        margin: 0;
        color: var(--text);
        font-family:
          -apple-system, BlinkMacSystemFont,
          "SF Pro Display", "SF Pro Text",
          system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        background:
          radial-gradient(circle at 20% 15%, rgba(124,58,237,.28), transparent 45%),
          radial-gradient(circle at 80% 25%, rgba(16,185,129,.18), transparent 45%),
          radial-gradient(circle at 50% 95%, rgba(124,58,237,.15), transparent 50%),
          linear-gradient(180deg, var(--bg0), var(--bg1));
        background-attachment: fixed;
        overflow-x: hidden;
      }

      .app {
        min-height: 100%;
        padding:
          calc(20px + var(--safeT))
          calc(20px + var(--safeR))
          calc(24px + var(--safeB))
          calc(20px + var(--safeL));
        display: flex;
        justify-content: center;
        align-items: stretch;
      }

      .shell {
        width: 100%;
        max-width: var(--maxW);
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      /* ===== TOPBAR ===== */
      .topbar {
        display: flex;
        align-items: center;
        justify-content: flex-start;
        gap: 12px;
        padding: 6px 4px;
      }

      .navBtn {
        height: 48px;
        min-width: 48px;
        padding: 0 16px;
        border-radius: 999px;
        border: 1px solid var(--stroke);
        background: color-mix(in srgb, var(--cardSolid) 65%, transparent);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        color: var(--text);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        cursor: pointer;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
        font-weight: 600;
        transition: transform .12s ease, background .2s ease, border-color .2s ease, opacity .25s ease, visibility .25s ease;
      }
      .navBtn:active { transform: scale(.96); }
      .navBtn[disabled] { opacity: .4; cursor: not-allowed; pointer-events: none; }
      .navBtn.hidden { opacity: 0; pointer-events: none; visibility: hidden; }
      .navBtn .icon { width: 20px; height: 20px; display: inline-flex; align-items: center; justify-content: center; }
      #skipBtn { margin-left: auto; }

      .brand { display:flex; align-items:center; gap:10px; min-width: 0; flex: 1; }
      .mark {
        width: 38px; height: 38px;
        border-radius: 14px;
        background:
          radial-gradient(16px 16px at 38% 35%, rgba(255,255,255,.6), transparent 60%),
          linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 12px 32px rgba(124, 58, 237, 0.35);
      }
      .brandText { display:flex; flex-direction:column; min-width:0; flex: 1; }
      .brandText b {
        font-size: 14px; letter-spacing:.2px;
        white-space: nowrap; overflow:hidden; text-overflow:ellipsis;
        max-width: 140px;
      }
      .brandText span {
        font-size: 12px; color: var(--muted2);
        white-space: nowrap; overflow:hidden; text-overflow:ellipsis;
      }

      /* ===== PROGRESS BAR ===== */
      .progressWrap { width: 100%; padding: 6px 4px 0; }
      .progressRow {
        display:flex; align-items:center; justify-content:space-between;
        gap: 10px; margin-bottom: 6px;
        color: var(--muted2); font-size: 11px;
      }
      .bar {
        height: 6px; border-radius: 999px;
        background: color-mix(in srgb, var(--stroke) 70%, transparent);
        overflow: hidden;
        border: 1px solid color-mix(in srgb, var(--stroke2) 75%, transparent);
      }
      .bar > i {
        display:block; height:100%; width:0%;
        border-radius: 999px;
        background: linear-gradient(90deg, var(--accent), var(--accent2));
        transition: width .32s cubic-bezier(.2,.8,.2,1);
      }

      /* ===== CARD ===== */
      .card {
        position: relative;
        border-radius: var(--radius);
        background: var(--card);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid color-mix(in srgb, var(--stroke) 80%, transparent);
        box-shadow: var(--shadow);
        padding: 18px;
        overflow: hidden;
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      .card::before {
        content: "";
        position: absolute;
        inset: -2px;
        pointer-events: none;
        background:
          radial-gradient(320px 180px at 25% 5%, rgba(124,58,237,.2), transparent 55%),
          radial-gradient(300px 200px at 85% 15%, rgba(16,185,129,.14), transparent 55%);
        opacity: .85;
      }
      .cardInner { 
        position: relative; 
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow-y: visible;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
      }
      .cardInner.scrollable {
        overflow-y: auto;
      }
      .cardInner::-webkit-scrollbar { width: 0; height: 0; }

      /* ===== TYPOGRAPHY ===== */
      h1 { margin: 2px 0 8px; font-size: 26px; line-height: 1.15; letter-spacing: -0.4px; font-weight: 700; }
      h1.large { font-size: 32px; }
      p.desc { margin: 0 0 12px; color: var(--muted); font-size: 14px; line-height: 1.45; }

      /* ===== FORM FIELDS ===== */
      .fields { display:flex; flex-direction:column; gap:10px; margin-top:6px; }
      .field { display:flex; flex-direction:column; gap:8px; }
      .labelRow { display:flex; align-items:baseline; justify-content:space-between; gap:10px; }
      label { font-size: 13px; color: color-mix(in srgb, var(--text) 92%, var(--muted)); letter-spacing:.2px; }
      .req { font-size: 12px; color: var(--muted2); }

      .control {
        display:flex; align-items:center; gap:10px;
        background: color-mix(in srgb, var(--cardSolid) 78%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        border-radius: var(--radiusSm);
        padding: 10px 12px;
        min-height: var(--tap);
        transition: border-color .2s ease, box-shadow .2s ease;
      }
      .control:focus-within {
        border-color: color-mix(in srgb, var(--accent) 50%, var(--stroke2));
        box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 15%, transparent);
      }

      input, select, button { font: inherit; color: inherit; }
      input[type="number"], input[type="text"], input[type="date"] {
        appearance: none; -webkit-appearance:none;
        border: 0; outline: none; background: transparent;
        width: 100%; font-size: 16px;
      }
      input[type="date"] { min-height: 22px; }

      select {
        border: 0; outline: none;
        background: transparent; color: var(--text);
        font-size: 14px;
        padding: 6px 10px;
        border-radius: 12px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 78%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 86%, transparent);
        min-width: 84px;
      }

      .hint { font-size: 12px; color: var(--muted2); margin-top: -2px; }

      /* ===== VALIDATION ERRORS ===== */
      .error {
        display:none;
        font-size: 12px;
        color: color-mix(in srgb, var(--danger) 90%, var(--text));
        margin-top: 2px;
        padding: 8px 10px;
        background: color-mix(in srgb, var(--danger) 10%, transparent);
        border-radius: 8px;
        border: 1px solid color-mix(in srgb, var(--danger) 20%, transparent);
        align-items: center;
        gap: 6px;
      }
      .error svg { 
        width: 14px; 
        height: 14px; 
        flex-shrink: 0;
        fill: currentColor;
      }
      .field.invalid .control {
        border-color: color-mix(in srgb, var(--danger) 70%, var(--stroke2));
        box-shadow: 0 0 0 3px color-mix(in srgb, var(--danger) 20%, transparent);
      }
      .field.invalid .error { display:flex; }

      /* ===== OPTIONS (RADIO BUTTONS) ===== */
      .options { display:flex; flex-direction:column; gap:8px; margin-top:8px; }
      .opt {
        text-align:left;
        width:100%;
        min-height: 50px;
        padding: 12px 12px;
        border-radius: 16px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 78%, transparent);
        cursor:pointer;
        -webkit-tap-highlight-color: transparent;
        display:flex; align-items:center; justify-content:space-between; gap:10px;
        transition: transform .08s ease, border-color .18s ease, background .18s ease;
      }
      .opt:active { transform: scale(.99); }
      .opt .sub { font-size: 11px; color: var(--muted2); margin-top: 1px; }
      .opt strong { display:block; font-size: 14px; }
      
      /* Option with icon */
      .opt .optIcon {
        width: 36px;
        height: 36px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        background: color-mix(in srgb, var(--accent) 12%, transparent);
        flex-shrink: 0;
        margin-right: 2px;
      }
      .opt .optContent { flex: 1; }

      .pill {
        width: 26px; height: 26px;
        border-radius: 999px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 80%, transparent);
        display:grid; place-items:center;
        flex: 0 0 auto;
        background: transparent;
      }
      .pill i {
        width: 14px; height: 14px;
        border-radius: 6px;
        background: transparent;
        transition: background .18s ease, transform .18s ease;
        transform: scale(.85);
      }
      .opt.selected {
        border-color: color-mix(in srgb, var(--accent) 70%, var(--stroke2));
        background: color-mix(in srgb, var(--accent) 12%, var(--cardSolid));
      }
      .opt.selected .pill {
        border-color: color-mix(in srgb, var(--accent) 70%, var(--stroke2));
        background: color-mix(in srgb, var(--accent) 18%, transparent);
      }
      .opt.selected .pill i {
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        transform: scale(1);
      }

      /* ===== SLIDER ===== */
      .sliderWrap { margin-top: 6px; display:flex; flex-direction:column; gap:8px; }
      .sliderHead { display:flex; align-items:baseline; justify-content:space-between; gap:8px; }
      .valueBubble { font-weight: 700; font-size: 16px; letter-spacing: -0.2px; }
      .unit { font-size: 11px; color: var(--muted2); margin-left: 4px; font-weight: 600; }

      input[type="range"] {
        width: 100%;
        height: 34px;
        background: transparent;
        padding: 0; margin: 0;
        -webkit-tap-highlight-color: transparent;
      }
      input[type="range"]::-webkit-slider-runnable-track{
        height: 8px;
        border-radius: 999px;
        background: color-mix(in srgb, var(--stroke) 70%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 72%, transparent);
      }
      input[type="range"]::-webkit-slider-thumb{
        -webkit-appearance:none;
        width: 26px; height: 26px; margin-top: -10px;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        border: 3px solid color-mix(in srgb, var(--cardSolid) 90%, transparent);
        box-shadow: 0 10px 26px rgba(0,0,0,.25);
      }
      input[type="range"]::-moz-range-track{
        height: 8px; border-radius: 999px;
        background: color-mix(in srgb, var(--stroke) 70%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 72%, transparent);
      }
      input[type="range"]::-moz-range-thumb{
        width: 26px; height: 26px;
        border-radius: 999px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        border: 3px solid color-mix(in srgb, var(--cardSolid) 90%, transparent);
        box-shadow: 0 10px 26px rgba(0,0,0,.25);
      }

      /* ===== FOOTER BUTTONS ===== */
      .footer { display:flex; gap:10px; margin-top:10px; }

      .btn {
        flex:1;
        min-height: 50px;
        border-radius: 16px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 78%, transparent);
        cursor:pointer;
        -webkit-tap-highlight-color: transparent;
        user-select:none;
        transition: transform .08s ease, background .18s ease, border-color .18s ease, opacity .18s ease;
        font-weight: 700;
        letter-spacing: .2px;
      }
      .btn:active { transform: scale(.99); }
      .btn.primary {
        border: none;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        box-shadow: 0 16px 38px rgba(109, 124, 255, 0.2);
        color: #0b0c10;
      }
      .btn.primary:disabled { opacity: .55; cursor:not-allowed; box-shadow:none; }
      .btn.ghost {
        background: transparent;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        color: var(--text);
      }
      .btn.secondary {
        background: color-mix(in srgb, var(--cardSolid) 90%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        color: var(--text);
      }

      /* ===== HERO SECTION ===== */
      .hero {
        margin: 8px 0 8px;
        border-radius: 18px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        background:
          radial-gradient(260px 120px at 20% 40%, rgba(109,124,255,.24), transparent 55%),
          radial-gradient(260px 120px at 80% 40%, rgba(39,211,167,.20), transparent 55%),
          linear-gradient(180deg, color-mix(in srgb, var(--cardSolid) 85%, transparent), transparent);
        height: 100px;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .hero::after {
        content: "";
        position: absolute;
        inset: 14px;
        border-radius: 14px;
        border: 1px dashed color-mix(in srgb, var(--stroke2) 70%, transparent);
        opacity: .7;
      }
      .heroBadge {
        position: absolute;
        left: 12px; top: 12px;
        padding: 6px 8px;
        border-radius: 999px;
        font-size: 11px;
        font-weight: 700;
        color: color-mix(in srgb, var(--text) 92%, var(--muted));
        background: color-mix(in srgb, var(--cardSolid) 70%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
      }
      .heroIcon {
        font-size: 42px;
        z-index: 1;
      }

      .row { display:flex; align-items:center; justify-content:space-between; gap:10px; }
      .srOnly { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }

      /* ===== PAGE TRANSITION ANIMATIONS ===== */
      .fadeIn { animation: fadeIn .32s cubic-bezier(.2,.8,.2,1) both; }
      @keyframes fadeIn { 
        from { opacity: 0; transform: translateY(12px);} 
        to { opacity:1; transform: translateY(0);} 
      }

      .slideInRight { animation: slideInRight .35s cubic-bezier(.2,.8,.2,1) both; }
      @keyframes slideInRight { 
        from { opacity: 0; transform: translateX(30px);} 
        to { opacity:1; transform: translateX(0);} 
      }

      .slideInLeft { animation: slideInLeft .35s cubic-bezier(.2,.8,.2,1) both; }
      @keyframes slideInLeft { 
        from { opacity: 0; transform: translateX(-30px);} 
        to { opacity:1; transform: translateX(0);} 
      }

      .scaleIn { animation: scaleIn .4s cubic-bezier(.2,.8,.2,1.2) both; }
      @keyframes scaleIn { 
        from { transform: scale(0.8); opacity:0;} 
        to { transform: scale(1); opacity:1;} 
      }

      .slideUp { animation: slideUp .35s ease both; }
      @keyframes slideUp { 
        from { opacity:0; transform: translateY(12px);} 
        to { opacity:1; transform: translateY(0);} 
      }

      /* ===== WELCOME SCREEN ===== */
      .welcomeWrap {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        flex: 1;
        text-align: center;
        gap: 12px;
        padding: 12px 0;
      }
      .welcomeAvatar {
        width: 88px;
        height: 88px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 42px;
        color: white;
        box-shadow: 0 16px 40px rgba(109, 124, 255, 0.35);
        animation: welcomePulse 2s ease-in-out infinite;
      }
      @keyframes welcomePulse {
        0%, 100% { transform: scale(1); box-shadow: 0 16px 40px rgba(109, 124, 255, 0.35); }
        50% { transform: scale(1.05); box-shadow: 0 20px 50px rgba(109, 124, 255, 0.45); }
      }
      .welcomeTitle {
        font-size: 26px;
        font-weight: 700;
        margin: 0;
        background: linear-gradient(135deg, var(--text), var(--accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .welcomeSubtitle {
        font-size: 14px;
        color: var(--muted);
        margin: 0;
        max-width: 280px;
      }

      /* ===== PERMISSION SCREENS ===== */

      /* Permission status pill (native prompt feedback) */
      .permissionStatusPill{
        display:inline-flex;
        align-items:center;
        gap:8px;
        padding: 10px 12px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 700;
        margin-top: 6px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 60%, transparent);
        background: color-mix(in srgb, var(--cardSolid) 72%, transparent);
        color: color-mix(in srgb, var(--text) 92%, var(--muted));
      }
      .permissionStatusPill.loading{
        color: var(--muted);
      }
      .permissionStatusPill.ok{
        border-color: color-mix(in srgb, var(--success) 35%, transparent);
        background: color-mix(in srgb, var(--success) 12%, transparent);
        color: color-mix(in srgb, var(--success) 92%, var(--text));
      }
      .permissionStatusPill.bad{
        border-color: color-mix(in srgb, var(--danger) 35%, transparent);
        background: color-mix(in srgb, var(--danger) 10%, transparent);
        color: color-mix(in srgb, var(--danger) 92%, var(--text));
      }
      .permissionStatusPill.neutral{
        color: var(--muted);
      }
      .permissionStatusPill .dot{
        width: 8px;
        height: 8px;
        border-radius: 999px;
        background: var(--muted2);
        flex: 0 0 auto;
        box-shadow: 0 0 0 3px color-mix(in srgb, currentColor 12%, transparent);
      }
      .permissionStatusPill .okDot{ background: var(--success); }
      .permissionStatusPill .badDot{ background: var(--danger); }
      .permissionStatusPill .neutralDot{ background: var(--muted2); }

      .spinner{
        width: 14px;
        height: 14px;
        border-radius: 50%;
        border: 2px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        border-top-color: color-mix(in srgb, var(--text) 85%, var(--muted));
        animation: spin .85s linear infinite;
        flex: 0 0 auto;
      }

      .floaty{
        animation: floaty 3.2s ease-in-out infinite;
      }
      @keyframes floaty{
        0%,100% { transform: translateY(0); }
        50% { transform: translateY(-6px); }
      }

      .permissionWrap {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        flex: 1;
        gap: 12px;
        padding: 6px 0;
      }
      .permissionIcon {
        width: 70px;
        height: 70px;
        border-radius: 20px;
        background: linear-gradient(135deg, rgba(109,124,255,.2), rgba(39,211,167,.15));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        margin-bottom: 4px;
      }
      .permissionTitle {
        font-size: 20px;
        font-weight: 700;
        margin: 0;
      }
      .permissionDesc {
        font-size: 13px;
        color: var(--muted);
        margin: 0;
        max-width: 300px;
        line-height: 1.4;
      }
      .permissionBenefits {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-top: 6px;
        width: 100%;
        max-width: 320px;
      }
      .benefitItem {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        background: color-mix(in srgb, var(--cardSolid) 80%, transparent);
        border-radius: 12px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 60%, transparent);
        text-align: left;
      }
      .benefitIcon {
        width: 28px;
        height: 28px;
        border-radius: 8px;
        background: color-mix(in srgb, var(--accent2) 15%, transparent);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        flex-shrink: 0;
      }
      .benefitText {
        font-size: 12px;
        color: var(--text);
      }

      /* ===== GOALS GENERATION ===== */
      .goalsGenWrap {
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        flex: 1;
        min-height: 280px;
        text-align:center;
        gap: 18px;
        width: 100%;
      }

      #goalsLoading {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        text-align: center;
      }

      #goalsResults {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 100%;
        text-align: center;
        flex: 1;
        min-height: 280px;
        gap: 18px;
      }

      .loadingCircles { 
        position:relative; 
        width:120px; 
        height:120px; 
        margin: 0 auto;
      }
      .loadingCircles .ring { position:absolute; inset:0; border-radius:50%; border: 3px solid transparent; }
      .loadingCircles .ring1 { border-top-color: var(--accent); border-right-color: var(--accent); animation: spin 1.2s linear infinite; }
      .loadingCircles .ring2 { inset: 12px; border-bottom-color: var(--accent2); border-left-color: var(--accent2); animation: spin 1.6s linear infinite reverse; }
      .loadingCircles .ring3 { inset: 24px; border-top-color: var(--accent); animation: spin 2s linear infinite; }
      .loadingCircles .centerIcon { position:absolute; inset:36px; display:grid; place-items:center; font-size: 32px; animation: pulse 1.5s ease-in-out infinite; }
      @keyframes spin { to { transform: rotate(360deg);} }
      @keyframes pulse { 0%,100% { transform: scale(1); opacity:1;} 50% { transform: scale(1.1); opacity:.8;} }

      .loadingStatus { font-size: 14px; color: var(--muted); animation: fadeIn .3s ease; }

      .successCheck {
        width: 70px; height: 70px; border-radius: 50%;
        background: linear-gradient(135deg, rgba(39,211,167,.2), rgba(39,211,167,.1));
        display:grid; place-items:center;
        font-size: 32px;
        animation: scaleIn .4s cubic-bezier(.2,.8,.2,1.2);
        margin: 0 auto;
      }

      .goalsCards { display:flex; flex-direction:column; gap:10px; width:100%; margin-top:6px; }

      .goalCard {
        display:flex;
        align-items:center;
        gap: 12px;
        padding: 14px;
        border-radius: 14px;
        background: color-mix(in srgb, var(--cardSolid) 85%, transparent);
        border: 1px solid color-mix(in srgb, var(--stroke2) 70%, transparent);
        animation: slideUp .35s ease both;
      }
      .goalCard:nth-child(1){ animation-delay: .05s; }
      .goalCard:nth-child(2){ animation-delay: .10s; }
      .goalCard:nth-child(3){ animation-delay: .15s; }
      .goalCard:nth-child(4){ animation-delay: .20s; }

      .goalIcon {
        width: 40px; height: 40px;
        border-radius: 10px;
        display:grid; place-items:center;
        font-size: 20px;
        flex: 0 0 auto;
      }
      .goalIcon.calories { background: linear-gradient(135deg, rgba(255,140,60,.25), rgba(255,90,40,.15)); }
      .goalIcon.protein { background: linear-gradient(135deg, rgba(255,90,122,.25), rgba(255,60,90,.15)); }
      .goalIcon.carbs { background: linear-gradient(135deg, rgba(39,211,167,.25), rgba(20,180,140,.15)); }
      .goalIcon.fat { background: linear-gradient(135deg, rgba(255,204,102,.25), rgba(255,180,60,.15)); }

      .goalInfo { flex: 1; text-align:left; }
      .goalInfo .label { font-size: 11px; color: var(--muted2); margin-bottom: 1px; }
      .goalInfo .value { font-size: 18px; font-weight: 700; letter-spacing: -0.2px; }
      .goalInfo .value .unit { font-size: 12px; font-weight: 600; color: var(--muted); margin-left: 3px; }

      .macrosRow { display:flex; gap:8px; }
      .macrosRow .goalCard { flex:1; flex-direction:column; text-align:center; padding: 12px 8px; }
      .macrosRow .goalIcon { width: 34px; height: 34px; font-size: 16px; }
      .macrosRow .goalInfo { text-align:center; }
      .macrosRow .goalInfo .value { font-size: 16px; }

      /* ===== CHARTS & GRAPHS ===== */
      .chartContainer {
        width: 100%;
        padding: 16px 0;
      }
      .chartTitle {
        font-size: 14px;
        font-weight: 600;
        color: var(--muted);
        margin-bottom: 12px;
      }
      
      /* Animated Bar Chart */
      .barChart {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      .barItem {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .barLabel {
        width: 100px;
        font-size: 13px;
        color: var(--text);
        flex-shrink: 0;
      }
      .barTrack {
        flex: 1;
        height: 24px;
        background: color-mix(in srgb, var(--stroke) 50%, transparent);
        border-radius: 12px;
        overflow: hidden;
        position: relative;
      }
      .barFill {
        height: 100%;
        border-radius: 12px;
        width: 0%;
        transition: width 1.2s cubic-bezier(.2,.8,.2,1);
      }
      .barFill.accent { background: linear-gradient(90deg, var(--accent), var(--accent2)); }
      .barFill.muted { background: color-mix(in srgb, var(--muted) 60%, transparent); }
      .barValue {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 12px;
        font-weight: 600;
        color: var(--text);
      }

      /* Comparison Chart */
      .comparisonChart {
        display: flex;
        flex-direction: column;
        gap: 20px;
        padding: 20px;
        background: color-mix(in srgb, var(--cardSolid) 60%, transparent);
        border-radius: 18px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 60%, transparent);
      }
      .comparisonItem {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .comparisonHeader {
        display: flex;
        align-items: center;
        justify-content: space-between;
      }
      .comparisonLabel {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        font-weight: 600;
      }
      .comparisonLabel.ourApp { color: var(--accent2); }
      .comparisonLabel.otherApps { color: var(--muted); }
      .comparisonLabel .appIcon {
        width: 24px;
        height: 24px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
      }
      .comparisonLabel.ourApp .appIcon { background: linear-gradient(135deg, var(--accent), var(--accent2)); }
      .comparisonLabel.otherApps .appIcon { background: var(--stroke); }
      .comparisonValue {
        font-size: 13px;
        font-weight: 700;
      }
      .comparisonTrack {
        height: 12px;
        background: color-mix(in srgb, var(--stroke) 40%, transparent);
        border-radius: 6px;
        overflow: hidden;
      }
      .comparisonFill {
        height: 100%;
        border-radius: 6px;
        width: 0%;
        transition: width 1.5s cubic-bezier(.2,.8,.2,1);
      }
      .comparisonFill.ourApp { background: linear-gradient(90deg, var(--accent), var(--accent2)); }
      .comparisonFill.otherApps { background: var(--muted2); }

      /* Circular Progress */
      .circularProgress {
        position: relative;
        width: 120px;
        height: 120px;
      }
      .circularProgress svg {
        transform: rotate(-90deg);
        width: 100%;
        height: 100%;
      }
      .circularProgress circle {
        fill: none;
        stroke-width: 8;
        stroke-linecap: round;
      }
      .circularProgress .track {
        stroke: color-mix(in srgb, var(--stroke) 50%, transparent);
      }
      .circularProgress .fill {
        stroke: url(#progressGradient);
        stroke-dasharray: 314;
        stroke-dashoffset: 314;
        transition: stroke-dashoffset 1.5s cubic-bezier(.2,.8,.2,1);
      }
      .circularProgress .centerText {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .circularProgress .percentage {
        font-size: 24px;
        font-weight: 700;
        color: var(--text);
      }
      .circularProgress .label {
        font-size: 11px;
        color: var(--muted);
      }

      /* ===== LANDING PAGES ===== */
      .landingWrap {
        display: flex;
        flex-direction: column;
        align-items: center;
        flex: 1;
        text-align: center;
        gap: 14px;
        padding: 6px 0;
      }
      .landingIcon {
        width: 70px;
        height: 70px;
        border-radius: 20px;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        box-shadow: 0 14px 36px rgba(109, 124, 255, 0.3);
      }
      .landingTitle {
        font-size: 22px;
        font-weight: 700;
        margin: 0;
      }
      .landingDesc {
        font-size: 13px;
        color: var(--muted);
        margin: 0;
        max-width: 300px;
        line-height: 1.4;
      }
      .statsGrid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        width: 100%;
        margin-top: 6px;
      }
      .statCard {
        padding: 14px;
        background: color-mix(in srgb, var(--cardSolid) 80%, transparent);
        border-radius: 14px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 60%, transparent);
        text-align: center;
      }
      .statCard .statValue {
        font-size: 24px;
        font-weight: 700;
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .statCard .statLabel {
        font-size: 11px;
        color: var(--muted);
        margin-top: 3px;
      }

      /* Activity level question */
      .activityOpts .opt .sub { max-width: 220px; }

      /* Gender selection */
      .genderOpts { display:flex; gap:10px; }
      .genderOpts .opt { flex:1; flex-direction:column; text-align:center; padding: 16px 12px; }
      .genderOpts .opt .genderIcon { font-size: 28px; margin-bottom: 6px; }

      /* Hidden state for topbar during generation */
      .topbar.hidden, .progressWrap.hidden {
        opacity: 0;
        pointer-events:none;
        transition: opacity .25s ease;
      }

      /* ===== AGE RESTRICTION NOTICE ===== */
      .ageNotice {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 12px;
        background: color-mix(in srgb, var(--warning) 12%, transparent);
        border: 1px solid color-mix(in srgb, var(--warning) 25%, transparent);
        border-radius: 10px;
        font-size: 12px;
        color: var(--warning);
        margin-top: 4px;
      }
      .ageNotice svg {
        width: 16px;
        height: 16px;
        fill: currentColor;
        flex-shrink: 0;
      }

      /* ===== WHEEL PICKER ===== */
      .wheel-picker-wrapper {
        position: relative;
        height: 132px;
        overflow: hidden;
        border-radius: 12px;
        background: color-mix(in srgb, var(--cardSolid) 60%, transparent);
      }

      .wheel-picker-container {
        height: 100%;
        overflow-y: scroll;
        scroll-snap-type: y mandatory;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
      }

      .wheel-picker-container::-webkit-scrollbar {
        display: none;
      }

      .wheel-picker-items {
        padding: 44px 0;
      }

      .wheel-picker-item {
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: 600;
        color: var(--muted);
        scroll-snap-align: center;
        transition: color 0.15s ease, transform 0.15s ease;
      }

      .wheel-picker-item.selected {
        color: var(--text);
        transform: scale(1.1);
      }

      .wheel-picker-gradient {
        position: absolute;
        left: 0;
        right: 0;
        height: 44px;
        pointer-events: none;
        z-index: 1;
      }

      .wheel-picker-gradient.top {
        top: 0;
        background: linear-gradient(to bottom, var(--cardSolid), transparent);
      }

      .wheel-picker-gradient.bottom {
        bottom: 0;
        background: linear-gradient(to top, var(--cardSolid), transparent);
      }

      .wheel-picker-indicator {
        position: absolute;
        left: 12px;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        height: 44px;
        border-top: 1px solid var(--stroke2);
        border-bottom: 1px solid var(--stroke2);
        pointer-events: none;
        z-index: 1;
      }

      .wheel-picker-field {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .wheel-picker-unit-toggle {
        display: flex;
        gap: 0;
        background: color-mix(in srgb, var(--cardSolid) 70%, transparent);
        border-radius: 10px;
        padding: 4px;
        border: 1px solid color-mix(in srgb, var(--stroke2) 60%, transparent);
      }

      .wheel-picker-unit-btn {
        flex: 1;
        padding: 8px 16px;
        border: none;
        background: transparent;
        color: var(--muted);
        font-size: 14px;
        font-weight: 600;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .wheel-picker-unit-btn.active {
        background: linear-gradient(135deg, var(--accent), var(--accent2));
        color: #fff;
      }

      /* ===== REDUCED MOTION ===== */
      @media (prefers-reduced-motion: reduce) {
        * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
      }

    </style>
  </head>

  <body>
    <div class="app">
      <div class="shell">
        <div class="topbar" id="topbar">
          <div class="brand" aria-label="Onboarding">
            <div class="mark" aria-hidden="true"></div>
            <div class="brandText">
              <b>Plan setup</b>
              <span id="stepMeta">Step</span>
            </div>
          </div>

          <button class="navBtn" id="skipBtn" type="button">
            <span style="font-weight:700;font-size:14px;">Skip</span>
          </button>
        </div>

        <div class="progressWrap" id="progressWrap" aria-hidden="true">
          <div class="progressRow">
            <span id="progressText">0%</span>
            <span id="progressSteps">0 / 0</span>
          </div>
          <div class="bar"><i id="progressFill"></i></div>
        </div>

        <div class="card" role="region" aria-live="polite" aria-atomic="true">
          <div class="cardInner" id="content"></div>
        </div>

        <div class="footer" id="footer"></div>
      </div>
    </div>

    <!-- SVG Gradient Definition for Charts -->
    <svg width="0" height="0" style="position:absolute">
      <defs>
        <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:var(--accent)"/>
          <stop offset="100%" style="stop-color:var(--accent2)"/>
        </linearGradient>
      </defs>
    </svg>

    <!-- JS injected exactly like splash_blue.html -->
    <!-- TEMPORARY FIX: Race condition workaround for local onboarding -->
    <!-- TODO: Remove when onboarding is migrated to SDK (like paywall) -->
    <script>
      // Legacy globals and start stub to avoid race before onboarding.js loads
      // This is a temporary fix until onboarding is served by the SDK
      (function () {
        window.SESSION_ID = window.SESSION_ID || "";
        window.CID = window.CID || "";
        window.USERID = window.USERID || "";
        window.APP_VERSION = window.APP_VERSION || "";
        if (typeof window.start !== "function") {
          window.start = function () {
            window.__pendingOnboardingStartArgs = arguments;
          };
        }
      })();
    </script>
    <script>#SPLASH_JS#</script>
  </body>
</html>
